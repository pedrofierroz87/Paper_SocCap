---
title: "SocCapUS"
format: html
editor: visual
---

# Social Capital, Territorial Inequalities, and the Rise of Anti-Establishment Narratives

Pedro Fierro, Francisco Rowe and Andrés Rodríguez-Pose

## Abstract

Historically, social capital has been perceived as a driver of voting behaviours, mainly through its influence on civic participation and trust. While it has traditionally been viewed as a counterforce against populist movements, recent studies have pointed out its dual nature, suggesting that in certain contexts, high levels of social capital could potentially fuel anti-establishment sentiments. Yet, social capital is multifaceted, reflecting diverse elements of social interaction. This study seeks to elucidate the nuanced roles various forms of social capital play in either strengthening or weakening support for anti-establishment narratives in specific territories.

Utilising data from META and drawing upon the recent methodologies proposed by Chetty et al. (2022a, 2022b), this paper employs three distinct indicators to measure social capital:

a.  Social connectedness: interaction among different "types" of people.
b.  Social cohesion: defined as clusters of friendships and
c.  Civic engagement: represented by volunteering rates.

Informed by past research, we hypothesise that the rise of anti-establishment narratives can be traced back to long-term economic and demographic downturns in areas characterised by stronger social capital. However, it is postulated that the significance and magnitude of the influence of social capital on anti-establishment narratives may vary depending on the specific dimension of social capital under consideration.

This research delves into the complex interplay between social capital, territorial disparities, and political unrest. With a refined approach to measurement, we aim to unveil the multifaceted influence of social capital on political dynamics in distinct territories.

## MOTIVATION

Previous research has proposed that social capital could be a factor affecting the endorsement of anti-establishment narratives. Specifically, concerning the United States, evidence indicates that counties with higher levels of social capital were more inclined to endorse Donald Trump in both the 2016 and 2020 elections, especially when taking into account recent economic decline.

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(tidyverse)
library(sf)
library(spdep)
library(foreign)
library(car)
library(broom)
library(interactions)
library(tigris)
library(corrplot)
library(ggthemes)
library(patchwork)
library(showtext)
library(scico)
```

# Set themes

Set font style

```{r}
# clean workspace
rm(list=ls())
# load font
font_add_google("Roboto Condensed", "robotocondensed")
# automatically use showtext to render text
showtext_auto()
```

Theme for maps

```{r}
theme_map <- function(...) {
  theme_tufte() +
  theme(
    text = element_text(family = "robotocondensed", size = 30),
    strip.text = element_text(size = 30),
    # legend
    legend.title=element_text(size=20), 
    legend.text=element_text(size=18),
    # remove all axes
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks = element_blank(),
    legend.position = "right"
    )
}
```

Theme for plots

```{r}
theme_tufte2 <- function(...) {
  theme_tufte() +
  theme(
    text = element_text(family = "robotocondensed", size = 24),
    )
}

```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
data_trump <- haven::read_dta("Data_SocCap/Golfing_Trump.dta")
data_meta <- read.csv("Data_SocCap/social_capital_county.csv")

# Creating variable for employment change 80-2016. Assuming EMP_AVE_80 and EMP_AVE_16 are the relevant variables
data_trump$Employment_Change = data_trump$EMP_AVE_16 - data_trump$EMP_AVE_80

##### Merging Data #####

data_trump$FIPS_ID <- as.numeric(data_trump$FIPS_ID)
data_meta$county <- as.numeric(data_meta$county)

data_trump2 <- merge(data_trump, data_meta, by.x = "FIPS_ID", by.y = "county", all = FALSE)
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
##### 5. Maping #####

counties <- st_read("Shapefile_SocCap/counties.shp")
counties <- counties %>%
  filter(!STATEFP %in% c("02", "15", "60", "66", "69", "72", "78")) # Excluding Alaska, Hawaii, and territories

counties$GEOID <- as.numeric(counties$GEOID)
summary(counties$GEOID)

counties <- merge(data_trump2, counties, by.x = "FIPS_ID", by.y = "GEOID", all.x = FALSE, all.y = TRUE)


```

**Figure 1** US Presidential Elections 2016 and 2020 (county level)

```{r echo=FALSE}

df_margin16 <- counties  %>% 
  dplyr::select(MAR_T_new, geometry) %>% 
  rename(margin = MAR_T_new) %>% 
  mutate(year = "2016")

df_margin20 <- counties  %>% 
  dplyr::select(MAR_T_20_new, geometry) %>% 
  rename(margin = MAR_T_20_new) %>% 
  mutate(year = "2020")

df_margin <- rbind( df_margin16,  
                    df_margin20)

margin_map <- ggplot(data = df_margin) +
  geom_sf(aes(fill = margin, geometry = geometry), color = "transparent", size = 0.5) +
  #scale_fill_viridis_c(name = "Trump margin", option = "C") +
  #scale_fill_distiller(palette = "RdBu", direction = -1) +
  scale_fill_scico(palette = 'vik',
                   guide = guide_colorbar(title.position="top")) +
  facet_wrap(~ year, 
             ncol = 1, strip.position = "top") +
  labs( fill = "Trump margin") +
  theme_map() +
  theme(strip.text = element_text(size = 25, face = "bold", hjust = 0, vjust = 1, angle = 0),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        legend.position = "bottom",
        legend.key.width = unit(2, "cm"),
        legend.key.height = unit(0.4, "cm"))
```

```{r}
png(filename = "./output/trump-margin1620.png", units="in", width=8, height=8, res=300, bg = "white")
  margin_map
dev.off()
```

**Figure 2** Histograms of US Presidential Elections 2016 and 2020 (county level)

```{r echo=FALSE}
# Unique plot
p <- ggplot() +
  # Histogram for MAR_T_new (2016)
  geom_histogram(data = data_trump, aes(x = MAR_T_new, y = ..density..), 
                 fill = "#440154FF", alpha = 0.7, bins = 70, color = "black") +
  # Histogram for MAR_T_20_new (2020)
  geom_histogram(data = data_trump, aes(x = MAR_T_20_new, y = ..density..), 
                 fill = "#FDE725FF", alpha = 0.7, bins = 70, color = "black") +
  labs(title = "Trump Margin: 2016 vs. 2020", 
       x = "Margin", y = "Frequency") +
  theme_tufte2() +
  # Adding a legend manually
  scale_fill_manual("", labels = c("2016", "2020"), values = c("#440154FF", "#FDE725FF")) +
  theme(title = element_text(size = 20, face = "bold", colour = "#000000"),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        axis.text = element_text(size = 15),
        axis.title = element_text(size = 18, face = "plain", colour = "#000000"))


# Display the plot
print(p)
```

```{r}
png(filename = "./output/hist_trump-margin.png", units="in", width=10, height=8, res=300, bg = "white")
  p
dev.off()
```

Nonetheless, it's important to acknowledge that social capital is not a one-dimensional concept. The tendency to view social capital as a single construct stems from practical limitations, particularly the scarcity of detailed data available at the county level. Recently, scholars have introduced a method for measuring distinct dimensions of social capital, including civic engagement, social cohesion, and economic connectedness.

**Figure 3** Civic Engagement Dimension

```{r echo=FALSE}
map_civorg <- ggplot(data = counties) +
  geom_sf(aes(fill = civic_organizations_county, geometry = geometry), color = "transparent", size = 0.5) +
  scale_fill_viridis_c(name = "Public for good Facebook pages per 1,000 users", 
                       option = "C",
                       guide = guide_colorbar(title.position="top")) +
  labs(title = "Civic Organizations") +
  theme_map() +
  theme(title = element_text(size = 20, face = "bold", colour = "#000000"),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        legend.position = "bottom",
        legend.key.width = unit(2.5, "cm"),
        legend.key.height = unit(0.4, "cm"))

map_vol <- ggplot(data = counties) +
  geom_sf(aes(fill = volunteering_rate_county, geometry = geometry), color = "transparent", size = 0.5) +
  scale_fill_viridis_c(name = "Percent of Facebook users in volunteering or activism", 
                       option = "C",
                       guide = guide_colorbar(title.position="top")) +
  labs(title = "Volunteering Rate") +
  theme_map() +
  theme(title = element_text(size = 20, face = "bold", colour = "#000000"),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        legend.position = "bottom", 
        legend.key.width = unit(2.5, "cm"),
        legend.key.height = unit(0.4, "cm"))

map_civorg / map_vol
```

```{r}
png(filename = "./output/civic-engagement.png", units="in", width=8, height=8, res=300, bg = "white")
  map_civorg / map_vol
dev.off()
```

**Figure 4** Social Cohesion Dimension

```{r echo=FALSE}
map_sup <- ggplot(data = counties) +
  geom_sf(aes(fill = support_ratio_county, geometry = geometry), color = "transparent", size = 0.5) +
  scale_fill_viridis_c(name = "Share of within-county Facebook friendships", 
                       option = "C",
                       guide = guide_colorbar(title.position="top")) +
  labs(title = "Support Network") +
  theme_map() +
  theme(title = element_text(size = 20, face = "bold", colour = "#000000"),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        legend.position = "bottom", 
        legend.key.width = unit(2.5, "cm"),
        legend.key.height = unit(0.4, "cm"))

map_clu <-  ggplot(data = counties) +
  geom_sf(aes(fill = clustering_county, geometry = geometry), color = "transparent", size = 0.5) +
  scale_fill_viridis_c(name = "Average share of Facebook friendship density", 
                       option = "C",
                       guide = guide_colorbar(title.position="top")) +
  labs(title = "Friendship clustering") +
  theme_map() +
  theme(title = element_text(size = 20, face = "bold", colour = "#000000"),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        legend.position = "bottom", 
        legend.key.width = unit(2.5, "cm"),
        legend.key.height = unit(0.4, "cm"))

map_sup / map_clu
```

```{r}
png(filename = "./output/social-cohesion.png", units="in", width=8, height=8, res=300, bg = "white")
  map_sup / map_clu
dev.off()
```

**Figure 5** Economic Connectedness Dimension

```{r echo=FALSE}
ggplot(data = counties) +
  geom_sf(aes(fill = ec_county, geometry = geometry), color = "transparent", size = 0.5) +
  scale_fill_viridis_c(name = "Share of high-SES and low-SES Facebook friendship", 
                       option = "C",
                       guide = guide_colorbar(title.position="top")) +
  labs(title = "Economic Connectedness") +
  theme_map() +
  theme(title = element_text(size = 20, face = "bold", colour = "#000000"),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        legend.position = "bottom", 
        legend.key.width = unit(2.5, "cm"),
        legend.key.height = unit(0.4, "cm"))
```

```{r}
png(filename = "./output/economic-connectedness.png", units="in", width=8, height=6, res=300, bg = "white")
  last_plot()
dev.off()
```

As evident from the data, each dimension exhibits unique territorial patterns, which can potentially influence the inclination to endorse anti-establishment narratives in distinct ways. This is the aspect we aim to investigate further.

It can be posited that dimensions linked to **homogeneous** networks may exhibit a positive correlation with anti-establishment perspectives. Conversely, dimensions associated with **heterogeneous** networks, signifying diversity, may demonstrate a negative relationship with support for anti-establishment sentiments.

### First Part: Replicating Classic Models

**Table 1** Classic models for Trump Margin 2016 and 2020

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# For 2016
model16_1 <- lm(MAR_T_new ~ INC_PC_16 + GINI_16 + factor(S_ID), data = data_trump)
summary(model16_1)
model16_3 <- lm(MAR_T_new ~ INC_PC_16 + SC5_PCM_14 + factor(S_ID), data = data_trump)
summary(model16_3)
```

```{r}
# For 2016
model16_5 <- lm(MAR_T_new ~ INC_PC_16 + GINI_16 + Employment_Change + SC5_PCM_14 + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = data_trump)
summary(model16_5)
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# For 2020
model20_1 <- lm(MAR_T_20_new ~ INC_PC_16 + GINI_16 + factor(S_ID), data = data_trump)
summary(model20_1)
model20_3 <- lm(MAR_T_20_new ~ INC_PC_16 + SC5_PCM_14 + factor(S_ID), data = data_trump)
summary(model20_3)
```

```{r}
# For 2020
model20_5 <- lm(MAR_T_20_new ~ INC_PC_16 + GINI_16 + Employment_Change + SC5_PCM_14 + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = data_trump)
summary(model20_5)
```

### Second Part: Replicating Classic Models with META Data

**Figure 6** Correlation Matrix

```{r}
data_trump3 <- select(data_trump2, MAR_T_new, INC_PC_16, GINI_16, EMP_AVE_CGR80_19, SC5_PCM_14, 
                     civic_organizations_county, volunteering_rate_county, clustering_county, 
                     support_ratio_county, ec_county, POP_DEN_16, UNE_16, EDU1_16, R_BLACK_16, 
                     SEX_RATIO, AGE_DEP_YOUNG, MARRIED)

cormat <- cor(data_trump3, use="complete.obs", method="pearson")

# significance test
sig1 <- corrplot::cor.mtest(data_trump3, conf.level = .95)

colnames(cormat) <- c("trump margin",
                      "income per capita", 
                      "inequality", 
                      "emp. change", 
                      "social capital community",
                      "civic organizations",
                      "volunteering",
                      "clustering",
                      "support_ratio",
                      "economic connectedness",
                      "density",
                      "unemployment",
                      "education",
                      "black population",
                      "sex ratio",
                      "age dependency",
                      "married")
rownames(cormat) <- c("trump margin",
                      "income per capita", 
                      "inequality", 
                      "emp. change", 
                      "social capital community",
                      "civic organizations",
                      "volunteering",
                      "clustering",
                      "support_ratio",
                      "economic connectedness",
                      "density",
                      "unemployment",
                      "education",
                      "black population",
                      "sex ratio",
                      "age dependency",
                      "married")
# creta a correlogram
corrplot::corrplot(cormat, type="lower",
                   method = "circle", 
                   order = "original", 
                   tl.cex = 0.7,
                   p.mat = sig1$p, sig.level = .05, 
                   col = viridis::viridis(100, option = "plasma"),
                   diag = FALSE)
```

```{r}
png(filename = "./output/correlagram.png", units="in", width=8, height=6, res=300, bg = "white")
  corrplot::corrplot(cormat, type="lower",
                   method = "circle", 
                   order = "original", 
                   tl.cex = 0.7,
                   p.mat = sig1$p, sig.level = .05, 
                   col = viridis::viridis(100, option = "plasma"),
                   diag = FALSE)
dev.off()
```

**Figure 7** Scatter plot for Trump Margin and Social Capital (classic and differentiating)

```{r echo=FALSE}
ggplot(data_trump2, aes(x = SC5_PCM_14, y = MAR_T_new, size = POP_DEN_16)) +
  geom_point(alpha = 0.5, color = "darkblue") +
  geom_smooth(method = "lm", color = "#FDE725FF", se = TRUE) +  # Add linear regression line
  labs(title = "Scatter Plot with Linear Trend",
       x = "Social Capital",
       y = "Trump Margin") +  # Removed size label here as the legend is being removed
  theme_tufte2() +
  scale_size_continuous(range = c(1, 10)) +
  guides(size = FALSE)  # Remove the size legend


ggplot(data_trump2, aes(x = civic_organizations_county, y = MAR_T_new, size = POP_DEN_16)) +
  geom_point(alpha = 0.5, color = "darkblue") +
  geom_smooth(method = "lm", color = "#FDE725FF", se = TRUE) +  # Add linear regression line
  labs(title = "Scatter Plot with Linear Trend",
       x = "Civic Organizations",
       y = "Trump Margin") +  # Removed size label here as the legend is being removed
  theme_tufte2() +
  scale_size_continuous(range = c(1, 10)) +
  guides(size = FALSE)  # Remove the size legend

ggplot(data_trump2, aes(x = volunteering_rate_county, y = MAR_T_new, size = POP_DEN_16)) +
  geom_point(alpha = 0.5, color = "darkblue") +
  geom_smooth(method = "lm", color = "#FDE725FF", se = TRUE) +  # Add linear regression line
  labs(title = "Scatter Plot with Linear Trend",
       x = "Volunteering Rates",
       y = "Trump Margin") +  # Removed size label here as the legend is being removed
  theme_tufte2() +
  scale_size_continuous(range = c(1, 10)) +
  guides(size = FALSE)  # Remove the size legend

ggplot(data_trump2, aes(x = clustering_county, y = MAR_T_new, size = POP_DEN_16)) +
  geom_point(alpha = 0.5, color = "darkblue") +
  geom_smooth(method = "lm", color = "#FDE725FF", se = TRUE) +  # Add linear regression line
  labs(title = "Scatter Plot with Linear Trend",
       x = "Friendship Clastering",
       y = "Trump Margin") +  # Removed size label here as the legend is being removed
  theme_tufte2() +
  scale_size_continuous(range = c(1, 10)) +
  guides(size = FALSE)  # Remove the size legend


ggplot(data_trump2, aes(x = support_ratio_county, y = MAR_T_new, size = POP_DEN_16)) +
  geom_point(alpha = 0.5, color = "darkblue") +
  geom_smooth(method = "lm", color = "#FDE725FF", se = TRUE) +  # Add linear regression line
  labs(title = "Scatter Plot with Linear Trend",
       x = "Support Networks",
       y = "Trump Margin") +  # Removed size label here as the legend is being removed
  theme_tufte2() +
  scale_size_continuous(range = c(1, 10)) +
  guides(size = FALSE)  # Remove the size legend

ggplot(data_trump2, aes(x = ec_county, y = MAR_T_new, size = POP_DEN_16)) +
  geom_point(alpha = 0.5, color = "darkblue") +
  geom_smooth(method = "lm", color = "#FDE725FF", se = TRUE) +  # Add linear regression line
  labs(title = "Scatter Plot with Linear Trend",
       x = "Economic Connectedness",
       y = "Trump Margin") +  # Removed size label here as the legend is being removed
  theme_tufte2() +
  scale_size_continuous(range = c(1, 10)) +
  guides(size = FALSE)  # Remove the size legend
```

Note: All models consider population density (size of circles)

**Table 2** Basic model for Trump Margin 2016, with META data

```{r}
# Civic Engagement
modelnew16_1 <- data_trump2 %>% rename(
   social_community = civic_organizations_county
   ) %>% 
  lm(MAR_T_new ~ INC_PC_16 + GINI_16 + Employment_Change + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew16_1)

modelnew16_2 <- data_trump2 %>% rename(
   social_community = volunteering_rate_county
   ) %>% 
  lm(MAR_T_new ~ INC_PC_16 + GINI_16 + Employment_Change + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew16_2)

# Social Cohesion
modelnew16_3 <- data_trump2 %>% rename(
   social_community = clustering_county
   ) %>%
  lm(MAR_T_new ~ INC_PC_16 + GINI_16 + Employment_Change + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew16_3)

modelnew16_4 <- data_trump2 %>% rename(
   social_community = support_ratio_county
   ) %>%
  lm(MAR_T_new ~ INC_PC_16 + GINI_16 + Employment_Change + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew16_4)

# Economic Connectedness
modelnew16_5 <- data_trump2 %>% rename(
   social_community = ec_county
   ) %>%
  lm(MAR_T_new ~ INC_PC_16 + GINI_16 + Employment_Change + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew16_5)
```

```{r}

plot_models(modelnew16_1, modelnew16_2,
            rm.terms = "factor(S_ID) [AL,AZ,AR,CA,CO,CT,DE,DC,FL,GA,HI,ID,IL,IN,IA,KS,KY,LA,ME,MD,MA,MI,MN,MS,MO,MT,NE,NV,NH,NJ,NM,NY,NC,ND,OH,OK,OR,PA,RI,SC,SD,TN,TX,UT,VT,VA,WA,WV,WI,WY]", 
            axis.labels = c(
    "Income per capita (2016)", "Inequality (Gini 2016)", "Employment change (1980-2016)", "Social Capital Community", "Density (2016)", "Unemployment rate (2016)", "Education (2016)", "Share of black population (2016)", "Sex ratio, males (2016)", "Age dependency, young (2016)", "Share Married (2016)")
  )
```

**Table 3** Basic model for Trump Margin 2020, with META data

```{r}
# Civic Engagement
modelnew20_1 <- lm(MAR_T_20_new ~ INC_PC_16 + GINI_16 + Employment_Change + civic_organizations_county + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = data_trump2)
summary(modelnew20_1)
modelnew20_2 <- lm(MAR_T_20_new ~ INC_PC_16 + GINI_16 + Employment_Change + volunteering_rate_county + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = data_trump2)
summary(modelnew20_2)

# Social Cohesion
modelnew20_3 <- lm(MAR_T_20_new ~ INC_PC_16 + GINI_16 + Employment_Change + clustering_county + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = data_trump2)
summary(modelnew20_3)
modelnew20_4 <- lm(MAR_T_20_new ~ INC_PC_16 + GINI_16 + Employment_Change + support_ratio_county + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = data_trump2)
summary(modelnew20_4)

# Economic Connectedness
modelnew20_5 <- lm(MAR_T_20_new ~ INC_PC_16 + GINI_16 + Employment_Change + ec_county + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = data_trump2)
summary(modelnew20_5)
```
