---
title: "SocCapUS"
format: html
editor: visual
---

# Social Capital and Voting Behaviour in the United States

Pedro Fierro, Francisco Rowe, Andrés Rodríguez-Pose and Ellen Helsper

## Abstract

Social capital has traditionally been viewed as a fundamental driver of democratic vitality. However, since the late-20th century, it has been suggested that social capital may also have adverse effects, potentially fostering totalitarian and populist ideologies. This paper examines the political implications of two different types of social capital ---bonding social capital and bridging social capital---, using the 2016 and 2020 U.S. presidential elections as a case study. By examining at the county level, we find that the impact of social capital on antisystem voting behaviour is contingent upon the type of social capital involved. Bonding social capital, characterised by close-knit, homogeneous networks, is positively correlated with antisystem behaviours, as proxied by the additional electoral support for Donald Trump. In contrast, bridging social capital, which involves connections across diverse social groups, shows a negative correlation. Furthermore, our analysis reveals a complex interaction between economic and demographic changes, social integration, and political tendencies in a period of economic transition. These findings underscore the multifaceted nature of social capital and its critical role in understanding its origins and effects.

## INTRODUCTION

Social capital has long been recognised as a crucial element in assessing the health and vitality of democratic systems and society at large. In recent years, concerns have grown over the health of democracy as voters across the democratic world increasingly turn to populist and/or anti-options. In electoral terms, social capital has been viewed as a catalyst for political engagement and voting behaviours, primarily through its influence on civic participation and trust (Coleman, 1988; Putnam, 1995, 2000). Yet, although social capital is typically seen as a positive counterforce against populist movements, some studies have highlighted its dual nature, suggesting that under certain conditions, high levels of social capital might foster anti-establishment sentiments (Fitzgerald & Lawrence, 2011; Rodríguez-Pose et al., 2021), and could be at the centre of the rise of the populist wave gripping many Western countries. Foundational studies of social capital reveal that the concept extends beyond a single dimension, comprising a variety of indicators that impact different aspects of social capital. This research adopts the well-known distinction between bonding and bridging social capital, hypothesising that each type of social capital has distinct effects on voting preferences of individuals. The aim is to explore the roles of different forms of social capital in either reinforcing or undermining electoral support for anti-establishment narratives in specific settings.\
Drawing on data from the META database and employing the methodologies recently developed by Chetty et al. (Chetty et al., 2022a, 2022b), we conceptualise social capital across three dimensions: a) social connectedness, which gauges interactions among individuals from diverse socioeconomic backgrounds; b) social cohesion, which is characterised by clusters of friendships and social networks; and c) civic engagement, which is denoted by volunteering rates and the presence of civic organisations within a community. Social cohesion and civic engagement are indicative of bonding social capital, strengthening networks within homogeneous communities. Conversely, social connectedness represents bridging social capital, characterised by diversity and interactions between different communities. Recent research suggests that the rise of antisystem narratives can often be traced back to persistent economic and demographic decline in areas with high levels of social capital (e.g. Rodríguez-Pose et al., 2024). We, however, posit that, although economic decline is a crucial driver of electoral support for more extreme options, this electoral support is fundamentally mediated by the relevance and type of social capital prevalent in each territory. Support for more extreme political options will differ depending on the specific type of social capital in question. Using Donald Trump's electoral performance in the 2016 and 2020 presidential elections as a case study, the findings of the analysis validate the hypotheses: bonding social capital is positively associated with Trump's vote margins ---serving as a proxy for the rise of antisystem behaviours in the US--- whereas the presence of bridging social capital shows a negative correlation with additional support for Donald Trump. Thus, it is not all dimensions of social capital that predispose a community to antisystem political action, but rather the presence of local, homogeneous networks. The article proceeds as follows: first, we examine the relationship between social capital and antisystem stances, followed by a discussion on the multidimensional nature of social capital. The methodology section then elaborates on the data and measures employed, outlining the analytical strategy adopted. Subsequently, we present and discuss the results of the empirical analysis, culminating in a conclusion that considers future research avenues and acknowledges the study's limitations. Through this research, we explore the complex interplay between social capital, territorial disparities, and support for antisystem narratives. By distinguishing between bonding and bridging connections, our aim is to unravel the influence of social capital on political dynamics across diverse territories.

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
library(tidyverse)
library(sf)
library(spdep)
library(foreign)
library(car)
library(broom)
library(interactions)
library(tigris)
library(corrplot)
library(ggthemes)
library(patchwork)
library(showtext)
library(scico)
library(sjPlot)
library(ggsci)
library(Hmisc)
library(psych)
```

# Set themes

Set font style

```{r}
# clean workspace
rm(list=ls())

options(scipen=999, # avoid scientific notation
        stringsAsFactors = FALSE, digits = 2)

options(digits = 7)

# load font
font_add_google("Roboto Condensed", "robotocondensed")
# automatically use showtext to render text
showtext_auto()
```

Theme for maps

```{r}
theme_map <- function(...) {
  theme_tufte() +
  theme(
    text = element_text(family = "robotocondensed", size = 30),
    strip.text = element_text(size = 30),
    # legend
    legend.title=element_text(size=20), 
    legend.text=element_text(size=18),
    # remove all axes
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    axis.ticks = element_blank(),
    legend.position = "right"
    )
}
```

Theme for plots

```{r}
theme_tufte2 <- function(...) {
  theme_tufte() +
  theme(
    text = element_text(family = "robotocondensed", size = 24),
    )
}

```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
data_trump <- haven::read_dta("Data_SocCap/Golfing_Trump.dta")
data_meta <- read.csv("Data_SocCap/social_capital_county.csv")

# Creating variable for employment change 80-2016. Assuming EMP_AVE_80 and EMP_AVE_16 are the relevant variables
data_trump$Employment_Change = data_trump$EMP_AVE_16 - data_trump$EMP_AVE_80

##### Merging Data #####

data_trump$FIPS_ID <- as.numeric(data_trump$FIPS_ID)
data_meta$county <- as.numeric(data_meta$county)

data_trump2 <- merge(data_trump, data_meta, by.x = "FIPS_ID", by.y = "county", all = FALSE)
```

```{r echo=FALSE, results='hide', message=FALSE, warning=FALSE}
##### 5. Maping #####

counties <- st_read("Shapefile_SocCap/counties.shp")
counties <- counties %>%
  filter(!STATEFP %in% c("02", "15", "60", "66", "69", "72", "78")) # Excluding Alaska, Hawaii, and territories

counties$GEOID <- as.numeric(counties$GEOID)
summary(counties$GEOID)

counties <- merge(data_trump2, counties, by.x = "FIPS_ID", by.y = "GEOID", all.x = FALSE, all.y = TRUE)


```

**Figure 1** US Presidential Elections 2016 and 2020 (county level)

```{r echo=FALSE}

df_margin16 <- counties  %>% 
  dplyr::select(MAR_T_new, geometry) %>% 
  rename(margin = MAR_T_new) %>% 
  mutate(year = "2016")

df_margin20 <- counties  %>% 
  dplyr::select(MAR_T_20_new, geometry) %>% 
  rename(margin = MAR_T_20_new) %>% 
  mutate(year = "2020")

df_margin <- rbind( df_margin16,  
                    df_margin20)

margin_map <- ggplot(data = df_margin) +
  geom_sf(aes(fill = margin, geometry = geometry), color = "transparent", size = 0.5) +
  #scale_fill_viridis_c(name = "Trump margin", option = "C") +
  #scale_fill_distiller(palette = "RdBu", direction = -1) +
  scale_fill_scico(palette = 'vik',
                   guide = guide_colorbar(title.position="top")) +
  facet_wrap(~ year, 
             ncol = 1, strip.position = "top") +
  labs( fill = "Trump margin") +
  theme_map() +
  theme(strip.text = element_text(size = 25, face = "bold", hjust = 0, vjust = 1, angle = 0),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        legend.position = "bottom",
        legend.key.width = unit(2, "cm"),
        legend.key.height = unit(0.4, "cm"))

margin_map
```

```{r}
png(filename = "./output/trump-margin1620.png", units="in", width=8, height=8, res=300, bg = "white")
  margin_map
dev.off()
```

**Figure 2** Histograms of US Presidential Elections 2016 and 2020 (county level)

```{r echo=FALSE}
# Unique plot
p <- ggplot() +
  # Histogram for MAR_T_new (2016)
  geom_histogram(data = data_trump, aes(x = MAR_T_new, y = ..density..), 
                 fill = "#440154FF", alpha = 0.7, bins = 70, color = "black") +
  # Histogram for MAR_T_20_new (2020)
  geom_histogram(data = data_trump, aes(x = MAR_T_20_new, y = ..density..), 
                 fill = "#FDE725FF", alpha = 0.7, bins = 70, color = "black") +
  labs(title = "Trump Margin: 2016 vs. 2020", 
       x = "Margin", y = "Frequency") +
  theme_tufte2() +
  # Adding a legend manually
  scale_fill_manual("", labels = c("2016", "2020"), values = c("#440154FF", "#FDE725FF")) +
  theme(title = element_text(size = 20, face = "bold", colour = "#000000"),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        axis.text = element_text(size = 15),
        axis.title = element_text(size = 18, face = "plain", colour = "#000000"))


# Display the plot
print(p)
```

```{r}
png(filename = "./output/hist_trump-margin.png", units="in", width=10, height=8, res=300, bg = "white")
  p
dev.off()
```

Nonetheless, it's important to acknowledge that social capital is not a one-dimensional concept. The tendency to view social capital as a single construct stems from practical limitations, particularly the scarcity of detailed data available at the county level. Recently, scholars have introduced a method for measuring distinct dimensions of social capital, including civic engagement, social cohesion, and economic connectedness.

**Figure 3** Civic Engagement Dimension

```{r echo=FALSE}
map_civorg <- ggplot(data = counties) +
  geom_sf(aes(fill = civic_organizations_county, geometry = geometry), color = "transparent", size = 0.5) +
  scale_fill_viridis_c(name = "Public good Facebook pages per 1,000 users", 
                       option = "C",
                       guide = guide_colorbar(title.position="top")) +
  labs(title = "Civic Organizations") +
  theme_map() +
  theme(title = element_text(size = 20, face = "bold", colour = "#000000"),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        legend.position = "bottom",
        legend.key.width = unit(2.5, "cm"),
        legend.key.height = unit(0.4, "cm"))

map_vol <- ggplot(data = counties) +
  geom_sf(aes(fill = volunteering_rate_county, geometry = geometry), color = "transparent", size = 0.5) +
  scale_fill_viridis_c(name = "Percent of Facebook users in volunteering or activism", 
                       option = "C",
                       guide = guide_colorbar(title.position="top")) +
  labs(title = "Volunteering Rate") +
  theme_map() +
  theme(title = element_text(size = 20, face = "bold", colour = "#000000"),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        legend.position = "bottom", 
        legend.key.width = unit(2.5, "cm"),
        legend.key.height = unit(0.4, "cm"))

map_civorg / map_vol
```

```{r}
png(filename = "./output/civic-engagement.png", units="in", width=8, height=8, res=300, bg = "white")
  map_civorg / map_vol
dev.off()
```

**Figure 4** Social Cohesion Dimension

```{r echo=FALSE}
map_sup <- ggplot(data = counties) +
  geom_sf(aes(fill = support_ratio_county, geometry = geometry), color = "transparent", size = 0.5) +
  scale_fill_viridis_c(name = "Share of within-county Facebook friendships", 
                       option = "C",
                       guide = guide_colorbar(title.position="top")) +
  labs(title = "Support Network") +
  theme_map() +
  theme(title = element_text(size = 20, face = "bold", colour = "#000000"),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        legend.position = "bottom", 
        legend.key.width = unit(2.5, "cm"),
        legend.key.height = unit(0.4, "cm"))

map_clu <-  ggplot(data = counties) +
  geom_sf(aes(fill = clustering_county, geometry = geometry), color = "transparent", size = 0.5) +
  scale_fill_viridis_c(name = "Average share of Facebook friendship density", 
                       option = "C",
                       guide = guide_colorbar(title.position="top")) +
  labs(title = "Friendship clustering") +
  theme_map() +
  theme(title = element_text(size = 20, face = "bold", colour = "#000000"),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        legend.position = "bottom", 
        legend.key.width = unit(2.5, "cm"),
        legend.key.height = unit(0.4, "cm"))

map_sup / map_clu
```

```{r}
png(filename = "./output/social-cohesion.png", units="in", width=8, height=8, res=300, bg = "white")
  map_sup / map_clu
dev.off()
```

**Figure 5** Economic Connectedness Dimension

```{r echo=FALSE}
ggplot(data = counties) +
  geom_sf(aes(fill = ec_county, geometry = geometry), color = "transparent", size = 0.5) +
  scale_fill_viridis_c(name = "Share of high-SES and low-SES Facebook friendship", 
                       option = "C",
                       guide = guide_colorbar(title.position="top")) +
  labs(title = "Economic Connectedness") +
  theme_map() +
  theme(title = element_text(size = 20, face = "bold", colour = "#000000"),
        legend.title = element_text(size=16, face = "plain", hjust=0.5, lineheight=0.45,        color="black"),
        legend.text=element_text(size=15),
        legend.position = "bottom", 
        legend.key.width = unit(2.5, "cm"),
        legend.key.height = unit(0.4, "cm"))
```

```{r}
png(filename = "./output/economic-connectedness.png", units="in", width=8, height=6, res=300, bg = "white")
  last_plot()
dev.off()
```


### Replicating Classic Models with META Data

**Figure 6** Correlation Matrix

```{r}
data_trump3 <- select(data_trump2, MAR_T_new, MAR_T_20_new, INC_PC_16, GINI_16, 
                     civic_organizations_county, volunteering_rate_county, clustering_county, 
                     support_ratio_county, ec_county, POP_DEN_16, UNE_16, EDU1_16, R_BLACK_16, 
                     SEX_RATIO, AGE_DEP_YOUNG, MARRIED)

cormat <- cor(data_trump3, use="complete.obs", method="pearson")

# significance test
sig1 <- corrplot::cor.mtest(data_trump3, conf.level = .95)

colnames(cormat) <- c("trump margin 16",
                      "trump margin 20",
                      "income per capita", 
                      "inequality", 
                      "civic organizations",
                      "volunteering",
                      "clustering",
                      "support ratio",
                      "economic connectedness",
                      "density",
                      "unemployment",
                      "education",
                      "black population",
                      "sex ratio",
                      "age dependency",
                      "married")
rownames(cormat) <- c("trump margin 16",
                      "trump margin 20",
                      "income per capita", 
                      "inequality", 
                      "civic organizations",
                      "volunteering",
                      "clustering",
                      "support ratio",
                      "economic connectedness",
                      "density",
                      "unemployment",
                      "education",
                      "black population",
                      "sex ratio",
                      "age dependency",
                      "married")
# creta a correlogram
corrplot::corrplot(cormat, type="lower",
                   method = "circle", 
                   order = "original", 
                   tl.cex = 0.7,
                   p.mat = sig1$p, sig.level = .05, 
                   col = viridis::viridis(100, option = "plasma"),
                   diag = FALSE)
```

```{r}
png(filename = "./output/correlagram.png", units="in", width=8, height=6, res=300, bg = "white")
  corrplot::corrplot(cormat, type="lower",
                   method = "circle", 
                   order = "original", 
                   tl.cex = 0.7,
                   p.mat = sig1$p, sig.level = .05, 
                   col = viridis::viridis(100, option = "plasma"),
                   diag = FALSE)
dev.off()
```


For R&R - Traditional correlation matriz
```{r}
# Compute correlation and significance
corr_test <- corr.test(data_trump3, use = "pairwise", method = "pearson", adjust = "none")

# Extract results
cormat <- corr_test$r
p_values <- corr_test$p

# Function to assign stars based on p-value
stars <- ifelse(p_values < 0.001, "***",
                ifelse(p_values < 0.01, "**",
                       ifelse(p_values < 0.05, "*", "")))

# Combine correlation coefficients and stars
cormat_stars <- paste0(round(cormat, 3), stars)

# Convert to a matrix for readability
cormat_stars <- matrix(cormat_stars, 
                       nrow = nrow(cormat),
                       dimnames = list(rownames(cormat), colnames(cormat)))

cormat_stars
```



**Table 1** Basic model for Trump Margin 2016, with META data

```{r}
# Civic Engagement
modelnew16_1 <- data_trump2 %>% rename(
   social_community = civic_organizations_county
   ) %>% 
  lm(MAR_T_new ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew16_1)

modelnew16_2 <- data_trump2 %>% rename(
   social_community = volunteering_rate_county
   ) %>% 
  lm(MAR_T_new ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew16_2)

# Social Cohesion
modelnew16_3 <- data_trump2 %>% rename(
   social_community = clustering_county
   ) %>%
  lm(MAR_T_new ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew16_3)

modelnew16_4 <- data_trump2 %>% rename(
   social_community = support_ratio_county
   ) %>%
  lm(MAR_T_new ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew16_4)

# Economic Connectedness
modelnew16_5 <- data_trump2 %>% rename(
   social_community = ec_county
   ) %>%
  lm(MAR_T_new ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew16_5)
```


```{r}
plot_models(modelnew16_1, modelnew16_2, modelnew16_3, modelnew16_4, modelnew16_5,
            title = "2016",
            legend.title = "",
            spacing = .7,
            std.est = "std2",
            line.size = 1,
            vline.color = "grey85",
            rm.terms = "factor(S_ID) [AL,AZ,AR,CA,CO,CT,DE,DC,FL,GA,HI,ID,IL,IN,IA,KS,KY,LA,ME,MD,MA,MI,MN,MS,MO,MT,NE,NV,NH,NJ,NM,NY,NC,ND,OH,OK,OR,PA,RI,SC,SD,TN,TX,UT,VT,VA,WA,WV,WI,WY]", 
            axis.labels = c(
              "Share Married (2016)", "Age dependency, young (2016)", "Sex ratio, males (2016)", "Share of black population (2016)", "Education (2016)", "Unemployment rate (2016)", "Density (2016)", "Social Capital Community", "Employment change (1980-2019)", "Inequality (Gini 2016)", "Income per capita (2016)"
              )
) + 
  scale_color_npg(labels = c("Economic connectedness", "Support network", "Frienship clustering", "Volunteering rate", "Civic organization")) + # Change colour palettes
  scale_fill_npg(labels = c("Economic connectedness", "Support network", "Frienship clustering", "Volunteering rate", "Civic organization")) +
  #scale_fill_discrete(name = "Dose", labels = c("A", "B")) +
  # scale_color_discrete(labels = c("Civic organization", "Volunteering rate", "Frienship clustering", "Support network", "Economic connectedness")) +
  theme_tufte2() +
  theme(
    text = element_text(family = "robotocondensed", size = 18),
    plot.title = element_text(size = 25),
    # legend
    legend.title=element_text(size=15), 
    legend.text=element_text(size=14),
    legend.position = "right"
  )
social_coh <- last_plot()
```


```{r}
png(filename = "./output/model-coef_social-capital_2016.png", units="in", width=8, height=8, res=300, bg = "white")
  last_plot()
dev.off()
```



**Table 2** Basic model for Trump Margin 2020, with META data

```{r}
# Civic Engagement
modelnew20_1 <- data_trump2 %>% rename(
   social_community = civic_organizations_county
   ) %>%
  lm(MAR_T_20_new ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew20_1)

modelnew20_2 <- data_trump2 %>% rename(
   social_community = volunteering_rate_county
   ) %>%
  lm(MAR_T_20_new ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew20_2)

# Social Cohesion
modelnew20_3 <- data_trump2 %>% rename(
   social_community = clustering_county
   ) %>%
  lm(MAR_T_20_new ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew20_3)

modelnew20_4 <- data_trump2 %>% rename(
   social_community = support_ratio_county
   ) %>%
  lm(MAR_T_20_new ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew20_4)

# Economic Connectedness
modelnew20_5 <- data_trump2 %>% rename(
   social_community = ec_county
   ) %>%
  lm(MAR_T_20_new ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelnew20_5)

```

```{r}
plot_models(modelnew20_1, modelnew20_2, modelnew20_3, modelnew20_4, modelnew20_5,
            title = "2020",
            legend.title = "",
            spacing = .7,
            std.est = "std2",
            line.size = 1,
            vline.color = "grey85",
            rm.terms = "factor(S_ID) [AL,AZ,AR,CA,CO,CT,DE,DC,FL,GA,HI,ID,IL,IN,IA,KS,KY,LA,ME,MD,MA,MI,MN,MS,MO,MT,NE,NV,NH,NJ,NM,NY,NC,ND,OH,OK,OR,PA,RI,SC,SD,TN,TX,UT,VT,VA,WA,WV,WI,WY]", 
            axis.labels = c(
              "Share Married (2016)", "Age dependency, young (2016)", "Sex ratio, males (2016)", "Share of black population (2016)", "Education (2016)", "Unemployment rate (2016)", "Density (2016)", "Social Capital Community", "Employment change (1980-2016)", "Inequality (Gini 2016)", "Income per capita (2016)"
              )
) + 
  scale_color_npg(labels = c("Economic connectedness", "Support network", "Frienship clustering", "Volunteering rate", "Civic organization")) + # Change colour palettes
  scale_fill_npg(labels = c("Economic connectedness", "Support network", "Frienship clustering", "Volunteering rate", "Civic organization")) +
  #scale_fill_discrete(name = "Dose", labels = c("A", "B")) +
  # scale_color_discrete(labels = c("Civic organization", "Volunteering rate", "Frienship clustering", "Support network", "Economic connectedness")) +
  theme_tufte2() +
  theme(
    text = element_text(family = "robotocondensed", size = 18),
    plot.title = element_text(size = 25),
    # legend
    legend.title=element_text(size=15), 
    legend.text=element_text(size=14),
    legend.position = "right"
  )
social_coh <- last_plot()
```
```{r}
png(filename = "./output/model-coef_social-capital_2020.png", units="in", width=8, height=8, res=300, bg = "white")
  last_plot()
dev.off()
```

### Third Part: Intractions Models with META Data

**Table 3** Interactions between social capital and economic change, 2016 elections.

```{r}
# For 2016 

data_trump2 <- data_trump2 %>%
  mutate(across(c(INC_PC_16, GINI_16, EMP_AVE_CGR80_19, POP_DEN_16, UNE_16, EDU1_16,
                  R_BLACK_16, SEX_RATIO, AGE_DEP_YOUNG, MARRIED, 
                  EMP_AVE_CGR80_19, EAR_AVE_JOB_CGR80_19, POP_CGR80_19, WA_SA_MEA_CGR80_19,
                  civic_organizations_county, volunteering_rate_county, clustering_county,
                  support_ratio_county, ec_county),
                ~ . - mean(., na.rm = TRUE),
                .names = "{.col}_c"))

# civic_organizations
modelint16_1 <- lm(MAR_T_new ~ INC_PC_16_c + GINI_16_c + EMP_AVE_CGR80_19_c +
                     civic_organizations_county_c + POP_DEN_16_c + UNE_16_c + EDU1_16_c +
                     R_BLACK_16_c + SEX_RATIO_c + AGE_DEP_YOUNG_c + MARRIED_c +
                     EMP_AVE_CGR80_19_c*civic_organizations_county_c +
                     EAR_AVE_JOB_CGR80_19_c*civic_organizations_county_c +
                     POP_CGR80_19_c*civic_organizations_county_c +
                     WA_SA_MEA_CGR80_19_c*civic_organizations_county_c +
                     factor(S_ID),
                   data = data_trump2)
summary(modelint16_1)
#vif(modelint16_1)

# volunteering_rate
modelint16_2 <- lm(MAR_T_new ~ INC_PC_16_c + GINI_16_c + EMP_AVE_CGR80_19_c +
                     volunteering_rate_county_c + POP_DEN_16_c + UNE_16_c + EDU1_16_c +
                     R_BLACK_16_c + SEX_RATIO_c + AGE_DEP_YOUNG_c + MARRIED_c +
                     EMP_AVE_CGR80_19_c*volunteering_rate_county_c +
                     EAR_AVE_JOB_CGR80_19_c*volunteering_rate_county_c +
                     POP_CGR80_19_c*volunteering_rate_county_c +
                     WA_SA_MEA_CGR80_19_c*volunteering_rate_county_c +
                     factor(S_ID),
                   data = data_trump2)
summary(modelint16_2)
#vif(modelint16_2)


#clustering_county
modelint16_3 <- lm(MAR_T_new ~ INC_PC_16_c + GINI_16_c + EMP_AVE_CGR80_19_c +
                     clustering_county_c + POP_DEN_16_c + UNE_16_c + EDU1_16_c +
                     R_BLACK_16_c + SEX_RATIO_c + AGE_DEP_YOUNG_c + MARRIED_c +
                     EMP_AVE_CGR80_19_c*clustering_county_c +
                     EAR_AVE_JOB_CGR80_19_c*clustering_county_c +
                     POP_CGR80_19_c*clustering_county_c +
                     WA_SA_MEA_CGR80_19_c*clustering_county_c +
                     factor(S_ID),
                   data = data_trump2)
summary(modelint16_3)
#vif(modelint16_3)


#support_ratio_county
modelint16_4 <- lm(MAR_T_new ~ INC_PC_16_c + GINI_16_c + EMP_AVE_CGR80_19_c +
                     support_ratio_county_c + POP_DEN_16_c + UNE_16_c + EDU1_16_c +
                     R_BLACK_16_c + SEX_RATIO_c + AGE_DEP_YOUNG_c + MARRIED_c +
                     EMP_AVE_CGR80_19_c*support_ratio_county_c +
                     EAR_AVE_JOB_CGR80_19_c*support_ratio_county_c +
                     POP_CGR80_19_c*support_ratio_county_c +
                     WA_SA_MEA_CGR80_19_c*support_ratio_county_c +
                     factor(S_ID),
                   data = data_trump2)
summary(modelint16_4)
#vif(modelint16_4)

#ec_county
modelint16_5 <- lm(MAR_T_new ~ INC_PC_16_c + GINI_16_c + EMP_AVE_CGR80_19_c +
                     ec_county_c + POP_DEN_16_c + UNE_16_c + EDU1_16_c +
                     R_BLACK_16_c + SEX_RATIO_c + AGE_DEP_YOUNG_c + MARRIED_c +
                     EMP_AVE_CGR80_19_c*ec_county_c +
                     EAR_AVE_JOB_CGR80_19_c*ec_county_c +
                     POP_CGR80_19_c*ec_county_c +
                     WA_SA_MEA_CGR80_19_c*ec_county_c +
                     factor(S_ID),
                   data = data_trump2)
summary(modelint16_5)
#vif(modelint16_5)


```

```{r}
interact_plot(modelint16_1, 
              pred = POP_CGR80_19_c, 
              modx = civic_organizations_county_c,
              data = data_trump2,      # Explicitly specify data
              interval = TRUE,
              main.title = "Population Growth x Organizations",
              x.label = "Population Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Organizations")

interact_plot(modelint16_2,
              pred = EMP_AVE_CGR80_19_c,
              modx = volunteering_rate_county_c,
              data = data_trump2,       # 
              interval = TRUE,
              main.title = "Employment Growth x Volunteering Rate",
              x.label = "Employment Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Volunteering Rate")

# Interaction: EAR_AVE_JOB_CGR80_19_c * clustering_county_c
interact_plot(modelint16_3,
              pred = EAR_AVE_JOB_CGR80_19_c,
              modx = clustering_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Earnings Growth x Clustering",
              x.label = "Earnings Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Clustering")

# Interaction: POP_CGR80_19_c * clustering_county_c
interact_plot(modelint16_3,
              pred = POP_CGR80_19_c,
              modx = clustering_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Population Growth x Clustering",
              x.label = "Population Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Clustering")

# Interaction: EMP_AVE_CGR80_19_c * support_ratio_county_c
interact_plot(modelint16_4,
              pred = EMP_AVE_CGR80_19_c,
              modx = support_ratio_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Employment Growth x Support Networks",
              x.label = "Employment Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Support Networks")

#Interaction: EAR_AVE_JOB_CGR80_19_c * support_ratio_county_c
interact_plot(modelint16_4,
              pred = EAR_AVE_JOB_CGR80_19_c,
              modx = support_ratio_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Earnings Growth x Support Networks",
              x.label = "Earnings Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Support Networks")

# Interaction: WA_SA_MEA_CGR80_19_c * support_ratio_county_c
interact_plot(modelint16_4,
              pred = WA_SA_MEA_CGR80_19_c,
              modx = support_ratio_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Wage Growth x Support Networks",
              x.label = "Wage Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Support Networks")

# Interaction: EMP_AVE_CGR80_19_c * ec_county_c
interact_plot(modelint16_5,
              pred = EMP_AVE_CGR80_19_c,
              modx = ec_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Employment Growth x Econ. Connect.",
              x.label = "Employment Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Econ. Connect.")

# Interaction: POP_CGR80_19_c * ec_county_c
interact_plot(modelint16_5,
              pred = POP_CGR80_19_c,
              modx = ec_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Population Growth x Econ. Connect.",
              x.label = "Population Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Econ. Connect.")

# Interaction: WA_SA_MEA_CGR80_19_c * ec_county_c
interact_plot(modelint16_5,
              pred = WA_SA_MEA_CGR80_19_c,
              modx = ec_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Wage Growth x Econ. Connect.",
              x.label = "Wage Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Econ. Connect.")

```


**Table 4** Interactions between social capital and economic change, 2020 elections.

```{r}
# For 2020 Employment Change

# civic_organizations
modelint20_1 <- lm(MAR_T_20_new ~ INC_PC_16_c + GINI_16_c + EMP_AVE_CGR80_19_c +
                     civic_organizations_county_c + POP_DEN_16_c + UNE_16_c + EDU1_16_c +
                     R_BLACK_16_c + SEX_RATIO_c + AGE_DEP_YOUNG_c + MARRIED_c +
                     EMP_AVE_CGR80_19_c*civic_organizations_county_c +
                     EAR_AVE_JOB_CGR80_19_c*civic_organizations_county_c +
                     POP_CGR80_19_c*civic_organizations_county_c +
                     WA_SA_MEA_CGR80_19_c*civic_organizations_county_c +
                     factor(S_ID),
                   data = data_trump2)
summary(modelint20_1)
#vif(modelint20_1)

# volunteering_rate
modelint20_2 <- lm(MAR_T_20_new ~ INC_PC_16_c + GINI_16_c + EMP_AVE_CGR80_19_c +
                     volunteering_rate_county_c + POP_DEN_16_c + UNE_16_c + EDU1_16_c +
                     R_BLACK_16_c + SEX_RATIO_c + AGE_DEP_YOUNG_c + MARRIED_c +
                     EMP_AVE_CGR80_19_c*volunteering_rate_county_c +
                     EAR_AVE_JOB_CGR80_19_c*volunteering_rate_county_c +
                     POP_CGR80_19_c*volunteering_rate_county_c +
                     WA_SA_MEA_CGR80_19_c*volunteering_rate_county_c +
                     factor(S_ID),
                   data = data_trump2)
summary(modelint20_2)
#vif(modelint20_2)


#clustering_county
modelint20_3 <- lm(MAR_T_20_new ~ INC_PC_16_c + GINI_16_c + EMP_AVE_CGR80_19_c +
                     clustering_county_c + POP_DEN_16_c + UNE_16_c + EDU1_16_c +
                     R_BLACK_16_c + SEX_RATIO_c + AGE_DEP_YOUNG_c + MARRIED_c +
                     EMP_AVE_CGR80_19_c*clustering_county_c +
                     EAR_AVE_JOB_CGR80_19_c*clustering_county_c +
                     POP_CGR80_19_c*clustering_county_c +
                     WA_SA_MEA_CGR80_19_c*clustering_county_c +
                     factor(S_ID),
                   data = data_trump2)
summary(modelint20_3)
#vif(modelint20_3)

#support_ratio_county
modelint20_4 <- lm(MAR_T_20_new ~ INC_PC_16_c + GINI_16_c + EMP_AVE_CGR80_19_c +
                     support_ratio_county_c + POP_DEN_16_c + UNE_16_c + EDU1_16_c +
                     R_BLACK_16_c + SEX_RATIO_c + AGE_DEP_YOUNG_c + MARRIED_c +
                     EMP_AVE_CGR80_19_c*support_ratio_county_c +
                     EAR_AVE_JOB_CGR80_19_c*support_ratio_county_c +
                     POP_CGR80_19_c*support_ratio_county_c +
                     WA_SA_MEA_CGR80_19_c*support_ratio_county_c +
                     factor(S_ID),
                   data = data_trump2)
summary(modelint20_4)
#vif(modelint20_4)


#ec_county
modelint20_5 <- lm(MAR_T_20_new ~ INC_PC_16_c + GINI_16_c + EMP_AVE_CGR80_19_c +
                     ec_county_c + POP_DEN_16_c + UNE_16_c + EDU1_16_c +
                     R_BLACK_16_c + SEX_RATIO_c + AGE_DEP_YOUNG_c + MARRIED_c +
                     EMP_AVE_CGR80_19_c*ec_county_c +
                     EAR_AVE_JOB_CGR80_19_c*ec_county_c +
                     POP_CGR80_19_c*ec_county_c +
                     WA_SA_MEA_CGR80_19_c*ec_county_c +
                     factor(S_ID),
                   data = data_trump2)
summary(modelint20_5)
#vif(modelint20_5)


```

```{r}
interact_plot(modelint20_2, 
              pred = EMP_AVE_CGR80_19_c, 
              modx = volunteering_rate_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Employment Growth x Volunteering Rate",
              x.label = "Employment Growth",
              y.label = "Predicted Trump's Margin (2020)",
              legend.main = "Volunteering Rate")

interact_plot(modelint20_3,
              pred = EMP_AVE_CGR80_19_c,
              modx = clustering_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Employment Growth × Clustering",
              x.label = "Employment Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Clustering")

interact_plot(modelint20_3,
              pred = POP_CGR80_19_c,
              modx = clustering_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Population Growth × Clustering",
              x.label = "Population Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Clustering")

interact_plot(modelint20_4,
              pred = EMP_AVE_CGR80_19_c,
              modx = support_ratio_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Employment Growth × Support Networks",
              x.label = "Employment Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Support Networks")

interact_plot(modelint20_4,
              pred = EAR_AVE_JOB_CGR80_19_c,
              modx = support_ratio_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Earnings Growth × Support Networks",
              x.label = "Earnings Growth",
              y.label = "Predicted Trump's Margin (2020)",
              legend.main = "Support Networks")

interact_plot(modelint20_4,
              pred = WA_SA_MEA_CGR80_19_c,
              modx = support_ratio_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Wages Growth × Support Networks",
              x.label = "Wages Growth",
              y.label = "Predicted Trump's Margin (2020)",
              legend.main = "Support Networks")

interact_plot(modelint20_5,
              pred = EMP_AVE_CGR80_19_c,
              modx = ec_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Employment Growth × Econ. Connect.",
              x.label = "Employment Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Econ. Connect.")

interact_plot(modelint20_5,
              pred = EAR_AVE_JOB_CGR80_19_c,
              modx = ec_county_c,
              data = data_trump2,
              interval = TRUE,
              main.title = "Earnings Growth × Econ. Connect.",
              x.label = "Earnings Growth",
              y.label = "Predicted Trump's Margin",
              legend.main = "Econ. Connect.")

```

R&R
```{r}
describe(data_trump$INC_PC_16)
describe(data_trump$GINI_16)
describe(data_trump$EMP_AVE_CGR80_19)
describe(data_trump$POP_DEN_16)
describe(data_trump$UNE_16)
describe(data_trump$EDU1_16)
describe(data_trump$R_BLACK_16)
describe(data_trump$SEX_RATIO)
describe(data_trump$AGE_DEP_YOUNG)
describe(data_trump$MARRIED)

# Civic Engagement
modelrev20_1 <- data_trump2 %>% rename(
   social_community = civic_organizations_county
   ) %>%
  lm(SHARE_T_20 ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelrev20_1)

modelrev20_2 <- data_trump2 %>% rename(
   social_community = volunteering_rate_county
   ) %>%
  lm(SHARE_T_20 ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelrev20_2)

# Social Cohesion
modelrev20_3 <- data_trump2 %>% rename(
   social_community = clustering_county
   ) %>%
  lm(SHARE_T_20 ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelrev20_3)

modelrev20_4 <- data_trump2 %>% rename(
   social_community = support_ratio_county
   ) %>%
  lm(SHARE_T_20 ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelrev20_4)

# Economic Connectedness
modelrev20_5 <- data_trump2 %>% rename(
   social_community = ec_county
   ) %>%
  lm(SHARE_T_20 ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelrev20_5)


```

```{r}
# Civic Engagement
modelrev16_1 <- data_trump2 %>% rename(
   social_community = civic_organizations_county
   ) %>%
  lm(SHARE_T ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelrev16_1)

modelrev16_2 <- data_trump2 %>% rename(
   social_community = volunteering_rate_county
   ) %>%
  lm(SHARE_T ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelrev16_2)

# Social Cohesion
modelrev16_3 <- data_trump2 %>% rename(
   social_community = clustering_county
   ) %>%
  lm(SHARE_T ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelrev16_3)

modelrev16_4 <- data_trump2 %>% rename(
   social_community = support_ratio_county
   ) %>%
  lm(SHARE_T ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelrev16_4)

# Economic Connectedness
modelrev16_5 <- data_trump2 %>% rename(
   social_community = ec_county
   ) %>%
  lm(SHARE_T ~ INC_PC_16 + GINI_16 + EMP_AVE_CGR80_19 + social_community + POP_DEN_16 + UNE_16 + EDU1_16 + R_BLACK_16 + SEX_RATIO + AGE_DEP_YOUNG + MARRIED + factor(S_ID), data = .)
summary(modelrev16_5)
```

